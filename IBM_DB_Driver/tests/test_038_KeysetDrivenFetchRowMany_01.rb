# 
#  Licensed Materials - Property of IBM
#
#  (c) Copyright IBM Corp. 2007,2008,2009
#

class TestIbmDb < Test::Unit::TestCase

  def test_038_KeysetDrivenFetchRowMany_01
    assert_expect do
      conn = IBM_DB::connect db,user,password

      result = IBM_DB::exec conn, "SELECT * FROM staff WHERE id < 101", {IBM_DB::SQL_ATTR_CURSOR_TYPE => IBM_DB::SQL_CURSOR_KEYSET_DRIVEN}

      while (row = IBM_DB::fetch_row(result))
        result2 = IBM_DB::prepare conn, "SELECT * FROM staff WHERE id < 101", {IBM_DB::SQL_ATTR_CURSOR_TYPE => IBM_DB::SQL_CURSOR_KEYSET_DRIVEN}
        IBM_DB::execute result2
        while (row2 = IBM_DB::fetch_row(result2))
         printf("%s : %s : %s : %s : %s\n", IBM_DB::result(result2, 0),
                                            IBM_DB::result(result2, 1),
                                            IBM_DB::result(result2, 2),
                                            IBM_DB::result(result2, 3),
                                            IBM_DB::result(result2, 5))
        end
      end
    end
  end

end

__END__
__LUW_EXPECTED__
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
__ZOS_EXPECTED__
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
__SYSTEMI_EXPECTED__
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
__IDS_EXPECTED__
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
10 : Sanders : 20 : Mgr   : 18357.50
20 : Pernal : 20 : Sales : 18171.25
30 : Marenghi : 38 : Mgr   : 17506.75
40 : OBrien : 38 : Sales : 18006.00
50 : Hanes : 15 : Mgr   : 20659.80
60 : Quigley : 38 : Sales : 16808.30
70 : Rothman : 15 : Sales : 16502.83
80 : James : 20 : Clerk : 13504.60
90 : Koonitz : 42 : Sales : 18001.75
100 : Plotz : 42 : Mgr   : 18352.80
